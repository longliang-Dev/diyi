<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- 增强移动端视口设置‌:ml-citation{ref="1" data="citationList"} -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>移动端摄像头调用</title>
    <style>
        body {
            margin: 0;
            background: #000;
            display: flex;
            justify-content: center;
            min-height: 100vh;
        }
        .camera-container {
            position: relative;
            width: 100%;
            max-width: 620px;  /* 适配大屏设备‌:ml-citation{ref="1" data="citationList"} */
        }
        #video {
            width: 100%;
            height: auto;
            transform: scaleX(-1);  /* 镜像翻转更自然‌:ml-citation{ref="2" data="citationList"} */
            object-fit: cover;  /* 保持视频比例‌:ml-citation{ref="3" data="citationList"} */
        }
        .beauty-text {
            position: absolute;
            bottom: -40px;  /* 与视频间距 */
            left: 50%;
            transform: translateX(-50%);
            color: #ff3860;
            font-size: 2rem;
            font-family: "Microsoft Yahei", sans-serif;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: fadeIn 1s ease-in;
            white-space: nowrap;
        }
        @media (max-width: 480px) {
            .beauty-text { font-size: 1.5rem; }  /* 小屏适配‌:ml-citation{ref="4" data="citationList"} */
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="camera-container">
        <video id="video" autoplay playsinline></video>  <!-- iOS必备属性‌:ml-citation{ref="4" data="citationList"} -->
        <div class="beauty-text">你的名字为龙家慧</div>
    </div>

    <script>
        // 兼容旧版API‌:ml-citation{ref="2,4" data="citationList"}
        if (navigator.mediaDevices === undefined) {
            navigator.mediaDevices = { getUserMedia: function() {} };
        }

        window.onload = function() {
            const video = document.getElementById('video');
            const errorHandler = (error) => {
                document.querySelector('.beauty-text').textContent = '摄像头访问失败';
                console.error('Error:', error);
            };

            // 优先使用后置摄像头‌:ml-citation{ref="2" data="citationList"}
            const constraints = {
                video: {
                    facingMode: 'environment',  // 后置摄像头
                    width: { ideal: 1920 },
                    height: { ideal: 1080 }
                }
            };

            // 新版API调用
            if(navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia(constraints)
                    .then(stream => {
                        video.srcObject = stream;
                        video.onloadedmetadata = () => video.play();
                    })
                    .catch(() => {
                        // 后置摄像头失败尝试前置‌:ml-citation{ref="4" data="citationList"}
                        constraints.video.facingMode = 'user';
                        navigator.mediaDevices.getUserMedia(constraints)
                            .then(stream => {
                                video.srcObject = stream;
                                video.play();
                            })
                            .catch(errorHandler);
                    });
            } else {
                errorHandler(new Error('浏览器不支持摄像头功能'));
            }
        };
    </script>
</body>
</html>